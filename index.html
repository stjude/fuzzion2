<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="[HIGH LEVEL DISCRIPTION.]">
        <meta name="author" content="St. Jude Cloud">
        
        <link rel="shortcut icon" href="img/favicon.ico">
        <title>[PROJECT NAME] - St. Jude</title>
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <link href="css/font-awesome.min.css" rel="stylesheet">
        <link href="css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/purebasic.min.css">

        <script src="js/jquery-1.10.2.min.js" defer></script>
        <script src="js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body class="homepage">
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href=".">[PROJECT NAME] - St. Jude</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a href="https://github.com/stjude[cloud]/REPO_NAME/edit/master/docs/index.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#fuzzion2" class="nav-link">fuzzion2</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#quick-start" class="nav-link">Quick Start</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#usage" class="nav-link">Usage</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#patterns" class="nav-link">Patterns</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#copyright" class="nav-link">COPYRIGHT</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#license" class="nav-link">LICENSE</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="fuzzion2">fuzzion2</h1>
<p>There are six programs in the Fuzzion2 suite: <code>fuzzion2</code>, <code>fuzzort</code>,
<code>fuzzum</code>, <code>fuzzion2html</code>, <code>fuzzall</code>, and <code>kmerank</code>.</p>
<p>The main program is <code>fuzzion2</code> which searches paired-end RNA or DNA to
identify read pairs that match fusion patterns.  The matching read pairs
are sorted by <code>fuzzort</code>; summarized by <code>fuzzum</code>; and converted to HTML by
<code>fuzzion2html</code> for viewing using a browser.  The <code>fuzzall</code> program
aggregates summaries produced by <code>fuzzum</code>.</p>
<p>The <code>fuzzion2</code> program requires as input a k-mer rank table.  Download
this file from <code>http://ftp.stjude.org/pub/software/fuzzion2_hg38_k15.krt</code>.
It holds a 4-GB 15-mer rank table that was constructed from the GRCh38 human
reference genome.  Use this file only when searching human RNA or DNA.
The <code>kmerank</code> program is provided to construct k-mer rank tables for other
species.  Depending on the size of the table under construction, you may
need to run <code>kmerank</code> with as much as 21 GB of memory.</p>
<p><em>When <code>fuzzion2</code> reads a 4-GB k-mer rank table into memory, be sure to run
it with at least 5 GB of memory.</em>  Each of the other programs in the Fuzzion2
suite requires less than 1 GB of memory.</p>
<h2 id="quick-start">Quick Start</h2>
<h3 id="docker">Docker</h3>
<p>Coming soon.</p>
<h3 id="developers-build">Developer's Build</h3>
<pre><code>$ git clone https://github.com/stjude/fuzzion2.git
$ cd fuzzion2
$ make
</code></pre>
<p>This builds executable files for all six programs of the Fuzzion2 suite and
puts them in <code>build/bin</code>.</p>
<h4 id="dependencies">Dependencies</h4>
<p>These programs are written in C++ and compiled using <a href="https://gcc.gnu.org/">g++</a> version 6 or later.</p>
<p><a href="https://github.com/samtools/htslib">HTSlib</a> version 1.10.2 or later is used to read BAM files.
Set <code>CPATH</code> and <code>LIBRARY_PATH</code> before running <code>make</code> and set
<code>LD_LIBRARY_PATH</code> before running <code>fuzzion2</code>.</p>
<pre><code>$ HTSLIB=HTSlib-installation-directory
$ export CPATH=$CPATH:$HTSLIB/include
$ export LIBRARY_PATH=$LIBRARY_PATH:$HTSLIB/lib
$ export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$HTSLIB/lib
</code></pre>
<p><a href="https://www.gnu.org/software/gzip/">gunzip</a> is used to decompress gzipped FASTQ data.</p>
<h2 id="usage">Usage</h2>
<pre><code>Usage: fuzzion2 OPTION ... [ubam_filename ...] &gt; hits

These options are required:
  -pattern=filename   name of pattern input file
  -rank=filename      name of binary  input file containing the k-mer rank table

The following are optional:
  -fastq1=filename    name of FASTQ Read 1 input file
  -fastq2=filename    name of FASTQ Read 2 input file
  -ifastq=filename    name of interleaved FASTQ input file (may be /dev/stdin)

The following are optional:
   N is a numeric value, e.g., -threads=4
  -maxins=N     maximum insert size in bases. . . . . . . . . . . . default 500
  -maxrank=N    maximum rank percentile of minimizers . . . . . . . default 95.0
  -maxtrim=N    maximum bases second read aligned ahead of first. . default 5
  -minbases=N   minimum percentile of matching bases. . . . . . . . default 90.0
  -minmins=N    minimum number of matching minimizers . . . . . . . default 3
  -minov=N      minimum overlap in number of bases. . . . . . . . . default 5
  -show=N       show best only (1) or all patterns (0) that match . default 1
  -single=N     show single-read (1) or just read-pair (0) matches. default 0
  -threads=N    number of threads . . . . . . . . . . . . . . . . . default 8
  -w=N          window length in number of bases. . . . . . . . . . default 5
</code></pre>
<p>The <code>-pattern</code> option is required and specifies the name of a text file containing
RNA or DNA patterns.  Look in the <code>patterns</code> directory for pattern files provided
with this distribution.</p>
<p>The <code>-rank</code> option is also required and specifies the name of a binary file
containing a k-mer rank table.  See the note above.</p>
<p><code>fuzzion2</code> examines each read pair to see if it matches any of the patterns in the
pattern file.  Read pairs are obtained from:</p>
<ol>
<li>a single interleaved FASTQ file named by the <code>-ifastq</code> option;</li>
<li>a pair of FASTQ files identified by the <code>-fastq1</code> and <code>-fastq2</code> options; or</li>
<li>one or more unaligned Bam files specified on the command line.</li>
</ol>
<p><code>fuzzion2</code> expects that the mates of a read pair are adjacent in interleaved FASTQ
files and unaligned Bam files.  If a pair of FASTQ files is specified, the mates
are separated; "Read 1" mates are in the first file and corresponding "Read 2"
mates are in the second file.  If the name of a FASTQ file ends with ".gz",
<code>fuzzion2</code> assumes that the file is gzipped and uses <code>gunzip</code> to decompress it.</p>
<p>Each read pair that matches a pattern is a "hit" and is written along with the
pattern on three lines to the standard output stream.  In the following example,
<code>BCR-ABL1</code> is the name of the pattern.  The second column of the first line shows
the substring of the pattern sequence that matches the read pair.  The second and
third lines show the read name and entire sequence of each mate.</p>
<pre><code>pattern BCR-ABL1                 CATCCGTGGAGCTGCAGATGCTGACCAACTCGTGTGTGAAACTCCAGACTGTCCACAGCATTCCGCTGACCATCAATAA]GGAAGA[AGCCCTTCAGCGGCCAGTAGCATCTGACTTTGAGCCTCAGGGTCTGAGTGAAGCCGCTCGTTGGAACTCCAAGGAAAACCTTCTCGCTGGACCCAGTGAAAATGACCCCAACCTTTTCGTTGC
read EXAMPLE:1105:12909:66982/2  CATCCGTGGAGCTGCAGATGCTGACCAACTCGTGTGTGAAACTCCAGACTGTCCACAGCATTCCGCTGACCATCAATAAGGAAGAAGCCCTTCAGCGGCCA
read EXAMPLE:1105:12909:66982/1                                                                                                               TCTGACTTTGAGCCTCAGGGTCTGAGTGAAGCCGCTCGTTGGAACTCCAAGGAAAACCTTCTCGCTGGACCCAGTGAAAATGACCCCAACCTTTTCGTTGC
</code></pre>
<p>A final line is written to the standard output stream showing the total number
of read pairs processed by the program.</p>
<p>When multithreading is used (i.e., the value of the <code>-threads</code> option is greater
than 1), the order of the hits is indeterminate and a simple <code>diff</code> cannot be
used to compare output files.  It is therefore recommended to run the <code>fuzzort</code>
program to sort the hits.  This program sorts the hits by pattern name so that
the hits are in a determinate order (and <code>diff</code> can be used to compare files)
and the hits of a pattern are grouped together.</p>
<pre><code>Usage: fuzzort &lt; fuzzion2_hits &gt; sorted_hits
</code></pre>
<p>If the read pairs for a sample are stored in multiple pairs of FASTQ files, run
<code>fuzzion2</code> once for each pair of FASTQ files and concatenate the resulting output
files.  Then run <code>fuzzort</code> on the concatenated file to get a single sorted file
of hits.</p>
<p>Run <code>fuzzion2html</code> to produce an HTML file that provides an attractive display
of hits when opened in a browser such as Google Chrome or Microsoft Edge.
SNPs, indels, and sequencing errors are highlighted in the display.</p>
<pre><code>Usage: fuzzion2html OPTION ... &lt; fuzzion2_hits &gt; html

The following is optional:
  -title=string   string to include in the title of the HTML page
</code></pre>
<p><code>fuzzum</code> produces a tab-delimited summary of hits, and these summaries may be
aggregated using the <code>fuzzall</code> program.</p>
<pre><code>Usage: fuzzum OPTION ... &lt; fuzzion2_hits &gt; hit_summary

This option is required:
  -id=string   identifies the sample

Usage: fuzzall fuzzum_filename ... &gt; pattern_summary
</code></pre>
<p>The <code>test</code> directory contains some files you can use to run a simple test:</p>
<pre><code>fuzzion2 -pattern=example_patterns.txt -rank=fuzzion2_hg38_k15.krt \
   -fastq1=example_input1.fq -fastq2=example_input2.fq &gt; my_output.txt

fuzzort &lt; my_output.txt &gt; my_sorted_output.txt

fuzzion2html -title=&quot;Fuzzion2 Example&quot; &lt; my_output.txt &gt; my_output.htm

fuzzum -id=example &lt; my_output.txt &gt; my_output_summary.txt
</code></pre>
<h2 id="patterns">Patterns</h2>
<p>(This section will describe the distributed pattern files, the format of patterns,
and the programs provided for creating patterns.)</p>
<h2 id="copyright">COPYRIGHT</h2>
<p>Copyright 2021 St. Jude Children's Research Hospital</p>
<h2 id="license">LICENSE</h2>
<p>Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at</p>
<pre><code>http://www.apache.org/licenses/LICENSE-2.0
</code></pre>
<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Â© 2021 St. Jude Children's Research Hospital</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = ".",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="js/base.js" defer></script>
        <script src="search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>

<!--
MkDocs version : 1.2.2
Build Date UTC : 2021-09-27 18:58:30.768297+00:00
-->
